<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fluorescent Reports • Luciernaga</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fluorescent Reports">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luciernaga</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/DataVisualization.html">Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/DimensionalityVisualization.html">Dimensionality Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/QualityControl.html">Quality Control</a></li>
    <li><a class="dropdown-item" href="../articles/FluorescenceSignatures.html">Fluorescence Signatures</a></li>
    <li><a class="dropdown-item" href="../articles/FluorescentReports.html">Fluorescent Reports</a></li>
    <li><a class="dropdown-item" href="../articles/Unmixing.html">Unmixing with Luciernaga</a></li>
    <li><a class="dropdown-item" href="../articles/Wetlab.html">Wetlab Helper Functions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DavidRach/Luciernaga/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fluorescent Reports</h1>
                        <h4 data-toc-skip class="author">David Rach</h4>
            <address class="author_afil">
      University of Maryland,
Baltimore<br><a class="author_email" href="mailto:#"></a><a href="mailto:drach@som.umaryland.edu" class="email">drach@som.umaryland.edu</a>
      </address>
                  
            <h4 data-toc-skip class="date">1 June 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DavidRach/Luciernaga/blob/HEAD/vignettes/FluorescentReports.rmd" class="external-link"><code>vignettes/FluorescentReports.rmd</code></a></small>
      <div class="d-none name"><code>FluorescentReports.rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette builds on what can be done with the outputs from the
<code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> function that was the main focus of
vignette 04_FluorescenceSignatures. Please read that vignette for all
the details regarding how the function processes the .fcs files into
individual signatures.</p>
<p>The following vignette covers the different functions that take these
<code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> outputs, either in the “data” or “fcs”
format, and process them into useful reports to gain insight into the
fluorescence signatures that are present within your unmixing controls
(both single-color and unstained). At the end of this vignette, we will
discuss how we can extend these reports to visualize changes in
signature across time to monitor for changes in antibody-vial quality or
instrument health.</p>
<p>Some of these functions we will cover in this vignette will also
resurface when we look at the Luciernaga unmixing functions that will be
covered in Vignette_06.</p>
</div>
<div class="section level2">
<h2 id="set-up">Set Up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h2>
<p>For this vignette, we will focus on characterizing the cell unmixing
controls. The following setup code is a repeat from previous vignettes,
and is used to provide the <code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> outputs needed
by the functions that we will be covering.</p>
<p>Let’s first load the required packages by calling them with
library.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davidrach.github.io/Luciernaga/">Luciernaga</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">flowCore</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">flowWorkspace</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">openCyto</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/ggcyto/issues" class="external-link">ggcyto</a></span><span class="op">)</span>  </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/htmltools" class="external-link">htmltools</a></span><span class="op">)</span></span></code></pre></div>
<p>Then we can find the .fcs files stored within the
<code>Luciernaga</code> packages extdata folder and sort them by their
respective type</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">FCS_Pattern</span> <span class="op">&lt;-</span> <span class="st">".fcs$"</span></span>
<span><span class="va">FCS_Files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">File_Location</span>, pattern <span class="op">=</span> <span class="va">FCS_Pattern</span>,</span>
<span>                        full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">FCS_Files</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span>, <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UnstainedFCSFiles</span> <span class="op">&lt;-</span> <span class="va">FCS_Files</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Unstained"</span>, <span class="va">FCS_Files</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">UnstainedBeads</span> <span class="op">&lt;-</span> <span class="va">UnstainedFCSFiles</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Beads"</span>, <span class="va">UnstainedFCSFiles</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">UnstainedCells</span> <span class="op">&lt;-</span> <span class="va">UnstainedFCSFiles</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Beads"</span>, <span class="va">UnstainedFCSFiles</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">BeadFCSFiles</span> <span class="op">&lt;-</span> <span class="va">FCS_Files</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Beads"</span>, <span class="va">FCS_Files</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">BeadSingleColors</span> <span class="op">&lt;-</span> <span class="va">BeadFCSFiles</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Unstained"</span>, <span class="va">BeadFCSFiles</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">CellSingleColorFiles</span> <span class="op">&lt;-</span> <span class="va">FCS_Files</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Cells"</span>, <span class="va">FCS_Files</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">CellSingleColors</span> <span class="op">&lt;-</span> <span class="va">CellSingleColorFiles</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="st">"Unstained"</span>, <span class="va">CellSingleColorFiles</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Now lets create a GatingSet for our single-color cell unmixing
controls</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyCytoSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/load_cytoset_from_fcs.html" class="external-link">load_cytoset_from_fcs</a></span><span class="op">(</span><span class="va">CellSingleColors</span>, </span>
<span>                                   truncate_max_range <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                   transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">MyCytoSet</span></span>
<span><span class="va">MyGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">MyCytoSet</span><span class="op">)</span></span>
<span><span class="va">MyGatingSet</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FileLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">MyGates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">FileLocation</span>, pattern <span class="op">=</span> <span class="st">'Gates.csv'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">MyGates</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyGatingTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gatingTemplate-class.html" class="external-link">gatingTemplate</a></span><span class="op">(</span><span class="va">MyGates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gt_gating.html" class="external-link">gt_gating</a></span><span class="op">(</span><span class="va">MyGatingTemplate</span>, <span class="va">MyGatingSet</span><span class="op">)</span></span>
<span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Now lets create a GatingSet for our unstained cell unmixing
controls</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyUnstainedCytoSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/load_cytoset_from_fcs.html" class="external-link">load_cytoset_from_fcs</a></span><span class="op">(</span><span class="va">UnstainedCells</span>, </span>
<span>                                   truncate_max_range <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                   transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">MyUnstainedCytoSet</span></span>
<span><span class="va">MyUnstainedGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">MyUnstainedCytoSet</span><span class="op">)</span></span>
<span><span class="va">MyUnstainedGatingSet</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FileLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">MyGates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">FileLocation</span>, pattern <span class="op">=</span> <span class="st">'Gates.csv'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">MyGates</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyGatingTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gatingTemplate-class.html" class="external-link">gatingTemplate</a></span><span class="op">(</span><span class="va">MyGates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gt_gating.html" class="external-link">gt_gating</a></span><span class="op">(</span><span class="va">MyGatingTemplate</span>, <span class="va">MyUnstainedGatingSet</span><span class="op">)</span></span>
<span><span class="va">MyUnstainedGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generate-luciernaga_qc-outputs">Generate Luciernaga_QC Outputs<a class="anchor" aria-label="anchor" href="#generate-luciernaga_qc-outputs"></a>
</h2>
<p>Now that the GatingSets are re-established, let’s continue where the
last vignette left off by processing all the fcs files with
<code>Luciernaga_QC</code> to characterize the fluorescent signatures
within.</p>
<p>Let’s first provision the AFOverlap csv to handle conflicts.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FileLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">pattern</span> <span class="op">=</span> <span class="st">"AutofluorescentOverlaps.csv"</span></span>
<span><span class="va">AFOverlap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">FileLocation</span>, pattern<span class="op">=</span><span class="va">pattern</span>,</span>
<span>                        full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">AFOverlap_CSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">AFOverlap</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">AFOverlap_CSV</span></span></code></pre></div>
<p>And next generate a CellAF unstained signature that can be used when
these fluorophore-autofluorescence overlap files are encountered:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pData(MyUnstainedGatingSet[1])</span></span>
<span><span class="va">removestrings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".fcs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TheCellAF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">MyUnstainedGatingSet</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, .f<span class="op">=</span><span class="va">Luciernaga_QC</span>, subsets<span class="op">=</span><span class="st">"lymphocytes"</span>,</span>
<span>                              removestrings<span class="op">=</span><span class="va">removestrings</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>,</span>
<span>                              unmixingcontroltype <span class="op">=</span> <span class="st">"cells"</span>, Unstained <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              ratiopopcutoff <span class="op">=</span> <span class="fl">0.001</span>, Verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              AFOverlap <span class="op">=</span> <span class="va">AFOverlap</span>, stats <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                              ExportType <span class="op">=</span> <span class="st">"data"</span>, SignatureReturnNow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              outpath <span class="op">=</span> <span class="va">TemporaryFolder</span>, Increments<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                              SecondaryPeaks<span class="op">=</span><span class="fl">2</span>, experiment <span class="op">=</span> <span class="st">"FirstExperiment"</span>,</span>
<span>                              condition <span class="op">=</span> <span class="st">"ILTPanel"</span>, SCData<span class="op">=</span><span class="st">"subtracted"</span>,</span>
<span>                              NegativeType<span class="op">=</span><span class="st">"default"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TheCellAF</span> <span class="op">&lt;-</span> <span class="va">TheCellAF</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co">#Removes list caused by map</span></span>
<span></span>
<span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">TheCellAF</span><span class="op">)</span></span></code></pre></div>
<p>We will start with the ExportType = “data” return for now for both
the cell Single-Color and Unstained Unmixing controls.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SingleColor_Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">MyGatingSet</span>, .f<span class="op">=</span><span class="va">Luciernaga_QC</span>, subsets<span class="op">=</span><span class="st">"lymphocytes"</span>,</span>
<span>                              removestrings<span class="op">=</span><span class="va">removestrings</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>,</span>
<span>                              unmixingcontroltype <span class="op">=</span> <span class="st">"cells"</span>, Unstained <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              ratiopopcutoff <span class="op">=</span> <span class="fl">0.001</span>, Verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              AFOverlap <span class="op">=</span> <span class="va">AFOverlap</span>, stats <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                              ExportType <span class="op">=</span> <span class="st">"data"</span>, SignatureReturnNow <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              outpath <span class="op">=</span> <span class="va">TemporaryFolder</span>, Increments<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                              SecondaryPeaks<span class="op">=</span><span class="fl">2</span>, experiment <span class="op">=</span> <span class="st">"FirstExperiment"</span>,</span>
<span>                              condition <span class="op">=</span> <span class="st">"ILTPanel"</span>, Subtraction <span class="op">=</span> <span class="st">"Internal"</span>, </span>
<span>                              CellAF<span class="op">=</span><span class="va">TheCellAF</span>, SCData<span class="op">=</span><span class="st">"subtracted"</span>,</span>
<span>                              NegativeType<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">SingleColor_Data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SingleColor_Data</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Let’s now repeat this process for the Unstained GatingSet.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pData(MyUnstainedGatingSet)</span></span>
<span></span>
<span><span class="va">Unstained_Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">MyUnstainedGatingSet</span>, .f<span class="op">=</span><span class="va">Luciernaga_QC</span>, subsets<span class="op">=</span><span class="st">"lymphocytes"</span>,</span>
<span>                              removestrings<span class="op">=</span><span class="va">removestrings</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>,</span>
<span>                              unmixingcontroltype <span class="op">=</span> <span class="st">"cells"</span>, Unstained <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                              ratiopopcutoff <span class="op">=</span> <span class="fl">0.001</span>, Verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              AFOverlap <span class="op">=</span> <span class="va">AFOverlap</span>, stats <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                              ExportType <span class="op">=</span> <span class="st">"data"</span>, SignatureReturnNow <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              outpath <span class="op">=</span> <span class="va">TemporaryFolder</span>, Increments<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                              SecondaryPeaks<span class="op">=</span><span class="fl">2</span>, experiment <span class="op">=</span> <span class="st">"FirstExperiment"</span>,</span>
<span>                              condition <span class="op">=</span> <span class="st">"ILTPanel"</span>, Subtraction <span class="op">=</span> <span class="st">"Internal"</span>, </span>
<span>                              CellAF<span class="op">=</span><span class="va">TheCellAF</span>, SCData<span class="op">=</span><span class="st">"subtracted"</span>,</span>
<span>                              NegativeType<span class="op">=</span><span class="st">"default"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Unstained_Data</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Unstained_Data</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="luciernaga_plots">Luciernaga_Plots<a class="anchor" aria-label="anchor" href="#luciernaga_plots"></a>
</h2>
<p>The <code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code> function works directly from the
<code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> output when the ExportType = “data”. Let’s
start exploring what it can do.</p>
<p>We will first provide a file.path to the panel information, which
will be used by <code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code> to arrange the
plots/report by the order of the fluorophores listed in the panel. If
there is a mismatch between the fluorophore data and the panel, it will
not rearrange but proceed to the output.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FileLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">pattern</span> <span class="op">=</span> <span class="st">"^Panel.csv"</span></span>
<span><span class="va">CSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">FileLocation</span>, pattern<span class="op">=</span><span class="va">pattern</span>, full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">TheFluorophoreOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">CSV</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The SingleColor_Data output from above currently contains the
information for every single fluorophore .fcs file that was processed.
While we can pass the entire object to <code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code>
and it will process a report for each, we can also tailor our output by
using <em><a href="https://CRAN.R-project.org/package=dplyr" class="external-link">dplyr</a></em> to target
particular fluorophores of interest if we want to find information for a
specific fluorophore.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BUV615</span> <span class="op">&lt;-</span> <span class="va">SingleColor_Data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="st">"BUV615"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">BUV615</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">BUV615</span><span class="op">)</span></span></code></pre></div>
<p>As you can tell, we processed <code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> with
increments set at 0.1 so there was a lot of splitting into specific
Clusters for this fluorophore. This can be overwhelming for
<code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code> default arguments in some individual
circumstances, such as the example below:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheFluorophoreOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">CSV</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">TheFluorophore</span> <span class="op">&lt;-</span> <span class="va">TheFluorophoreOrder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Fluorophore</span> <span class="op"><a href="https://rdrr.io/pkg/flowCore/man/filter-in-methods.html" class="external-link">%in%</a></span> <span class="st">"BUV615"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.001</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">TRUE</span>, CosinePlots<span class="op">=</span><span class="cn">TRUE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>To work around this, when the data.frame is handed to
<code>Luciernaga_Plot()</code>, we can filter by CellPopRatio to dictate
what percentage of the total outputed cells a Cluster needs to be to be
visualized. For the clusters that are excluded, these are gathered by
the function and classified as Cluster “Other”. Let’s see this in action
by setting CellPopRatio to 0.05 (so a cluster is retained if it makes up
5% stained cells):</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheFluorophoreOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">CSV</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">TheFluorophore</span> <span class="op">&lt;-</span> <span class="va">TheFluorophoreOrder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Fluorophore</span> <span class="op"><a href="https://rdrr.io/pkg/flowCore/man/filter-in-methods.html" class="external-link">%in%</a></span> <span class="st">"BUV615"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">TRUE</span>, CosinePlots<span class="op">=</span><span class="cn">TRUE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>From the above we can see the basic available formats of the
<code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code> outputs. Namely, from the
<code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> output we can visualize LinePlots (showing
visualized signatures), CosinePlots (showing the cosine similarity
matrix values of individual signatures relative to each other),
StackedBarPlots and HeatmapPlots (which in different ways show relative
abundance of the cluster signatures).</p>
<p>For the above example, we are using the returntype=“patchwork”
argument. As with other <code>Luciernaga</code> packages, it takes the
same arguments that are passed to the <code><a href="../reference/Utility_Patchwork.html">Utility_Patchwork()</a></code>
function to dictate layout. Similarly, we can set returntype = “pdf” to
generate a .pdf file with the report contents sent to the location
specified by the outfolder and filename.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">TRUE</span>, CosinePlots<span class="op">=</span><span class="cn">TRUE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span>, thecolumns<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                  therows<span class="op">=</span><span class="fl">2</span>, width<span class="op">=</span><span class="fl">7</span>, height<span class="op">=</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>In the cases above, the report returned all four plots. These can be
turned on or off as desired. For example, if we want to only retrieve
only individual plot elements, we would leave our desired plot value as
TRUE, set the other plot arguments to FALSE.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">TRUE</span>, CosinePlots<span class="op">=</span><span class="cn">FALSE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span>, thecolumns<span class="op">=</span><span class="fl">2</span>,</span>
<span>                                  therows<span class="op">=</span><span class="fl">2</span>, width<span class="op">=</span><span class="fl">7</span>, height<span class="op">=</span><span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Additionally, we would switch from returntype = “patchwork” to
“plots” to retrieve the actual ggplot2 object of interest. The returned
objects are still in a list format, so we use
<code>rCRANpkg("purrr")</code> flatten function to get rid of the list,
allowing the ggplot2 object to be handed to
<code>rCRANpkg("plotly")</code> ggplotly function to allow for
interactive elements.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"plots"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">TRUE</span>, CosinePlots<span class="op">=</span><span class="cn">FALSE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">FALSE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">)</span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"plots"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">FALSE</span>, CosinePlots<span class="op">=</span><span class="cn">TRUE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">FALSE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">)</span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"plots"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">FALSE</span>, CosinePlots<span class="op">=</span><span class="cn">FALSE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">FALSE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">)</span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">BUV615</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"plots"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">FALSE</span>, CosinePlots<span class="op">=</span><span class="cn">FALSE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu">flatten</span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">)</span></span>
<span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">ThePlotReport</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>Since the returned plots are ggplot2 objects, you can additionally
modify them further using ggplot2 arguments to change respective
elements appearance and aesthetics however you see fit. Please refer to
<code>rCRANpkg("ggplot2")</code> vignettes and tutorials on how to do
this, as it’s outside of our scope for this vignette.</p>
<p>Having characterized the pieces of <code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code>
for a single fluorophore, let’s quickly see how it behaves without the
initial filtering for the entire SC_Data</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheFluorophoreOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">CSV</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">SingleColor_Data</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"patchwork"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">TRUE</span>, CosinePlots<span class="op">=</span><span class="cn">TRUE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span><span class="va">ThePlotReport</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre></div>
<p>As can be seen, it automatically processed the data for each
individual fluorophore. As with the above, the arguments can be altered
to turn on/off individual plot elements, change the orientation, and
alter the return type as with the examples above.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheFluorophoreOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">CSV</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">SingleColor_Data</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"plots"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">FALSE</span>, CosinePlots<span class="op">=</span><span class="cn">FALSE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">TheFluorophore</span><span class="op">)</span></span>
<span><span class="va">ThePlotReport</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre></div>
<p>The examples above relied on <code>LuciernagaQC()</code> ExportType =
“data” output to generate the desired reports and plots. This can be
saved by individual users as a .csv that can be retrieved for later
use.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Saving Elsewhere</span></span>
<span><span class="va">StorageLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span><span class="va">TheName</span> <span class="op">&lt;-</span> <span class="st">"SingleColorData.csv"</span></span>
<span><span class="va">TheFinalLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">StorageLocation</span>, <span class="va">TheName</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">SingleColor_Data</span>, <span class="va">TheFinalLocation</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reading in Later</span></span>
<span><span class="va">TheRetrievedData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">TheFinalLocation</span>, check.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="luciernaga_fcstoreport">Luciernaga_FCSToReport<a class="anchor" aria-label="anchor" href="#luciernaga_fcstoreport"></a>
</h2>
<p><code><a href="../reference/Luciernaga_FCSToReport.html">Luciernaga_FCSToReport()</a></code> is a function that handles
cases when there is no <code>LuciernagaQC()</code> ExportType = “data”
to allow for the generation of plots and reports, and instead, we need
to take the <code>LuciernagaQC()</code> ExportType = “fcs” outputs from
their storage folder and re-derrive the equivalent data to be used with
<code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code>.</p>
<p>To demonstrate this, let’s first switch the
<code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> ExportType argument to “fcs” and store the
same single-color output .fcs files within the temporary folder in a
specific folder where we can retrieve them again when needed:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">StorageLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"LuciernagaTemporaryExamples"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">StorageLocation</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">StorageLocation</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">SingleColor_Data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">MyGatingSet</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">22</span>, <span class="fl">25</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span><span class="op">]</span>, .f<span class="op">=</span><span class="va">Luciernaga_QC</span>, subsets<span class="op">=</span><span class="st">"lymphocytes"</span>,</span>
<span>                              removestrings<span class="op">=</span><span class="va">removestrings</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>,</span>
<span>                              unmixingcontroltype <span class="op">=</span> <span class="st">"cells"</span>, Unstained <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              ratiopopcutoff <span class="op">=</span> <span class="fl">0.001</span>, Verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              AFOverlap <span class="op">=</span> <span class="va">AFOverlap</span>, stats <span class="op">=</span> <span class="st">"median"</span>,</span>
<span>                              ExportType <span class="op">=</span> <span class="st">"fcs"</span>, Brightness<span class="op">=</span><span class="cn">TRUE</span>, SignatureReturnNow <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                              outpath <span class="op">=</span> <span class="va">StorageLocation</span>, Increments<span class="op">=</span><span class="fl">0.1</span>,</span>
<span>                              SecondaryPeaks<span class="op">=</span><span class="fl">2</span>, experiment <span class="op">=</span> <span class="st">"FirstExperiment"</span>,</span>
<span>                              condition <span class="op">=</span> <span class="st">"ILTPanel"</span>, Subtraction <span class="op">=</span> <span class="st">"Internal"</span>, </span>
<span>                              CellAF<span class="op">=</span><span class="va">TheCellAF</span>, SCData<span class="op">=</span><span class="st">"subtracted"</span>,</span>
<span>                              NegativeType<span class="op">=</span><span class="st">"default"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TheLuciernagaOutputs_FCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">StorageLocation</span>, pattern<span class="op">=</span><span class="st">"fcs"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">TheLuciernagaOutputs_FCS</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">TheLuciernagaOutputs_CSV</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">StorageLocation</span>, pattern<span class="op">=</span><span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">TheLuciernagaOutputs_CSV</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>We can now proceed to evaluate
<code><a href="../reference/Luciernaga_FCSToReport.html">Luciernaga_FCSToReport()</a></code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ReferencePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">PanelPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ReferencePath</span>, <span class="st">"Panel.csv"</span><span class="op">)</span></span>
<span><span class="co">#PanelNames &lt;- read.csv(PanelPath, check.names = FALSE)</span></span>
<span><span class="co">#PanelNames &lt;- PanelNames %&gt;% pull(Fluorophore) %&gt;% gsub("-A", "", .)</span></span>
<span></span>
<span><span class="va">ReportOutput</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_FCSToReport.html">Luciernaga_FCSToReport</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">StorageLocation</span>, reference<span class="op">=</span><span class="va">PanelPath</span>, stats<span class="op">=</span><span class="st">"median"</span>,</span>
<span>                      RetainedType <span class="op">=</span> <span class="st">"normalized"</span>, experiment<span class="op">=</span><span class="st">"FirstExperiment"</span>,</span>
<span>                      condition<span class="op">=</span><span class="st">"ILTExperiment"</span>, TheSummary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ReportOutput</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>As you can see, we have returned a <code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> style
output that we can now evaluate using <code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code> as
described above:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlotReport</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">ReportOutput</span>, RetainedType<span class="op">=</span><span class="st">"normalized"</span>, CellPopRatio<span class="op">=</span><span class="fl">0.05</span>,</span>
<span>                                  outfolder<span class="op">=</span><span class="cn">NULL</span>, filename<span class="op">=</span><span class="st">"LuciernagaReport"</span>, returntype<span class="op">=</span><span class="st">"plots"</span>,</span>
<span>                                  LinePlots<span class="op">=</span><span class="cn">FALSE</span>, CosinePlots<span class="op">=</span><span class="cn">FALSE</span>, StackedBarPlots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  HeatmapPlots <span class="op">=</span> <span class="cn">TRUE</span>, reference <span class="op">=</span> <span class="va">PanelPath</span><span class="op">)</span></span>
<span><span class="va">ThePlotReport</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="luciernaga_brightness">Luciernaga_Brightness<a class="anchor" aria-label="anchor" href="#luciernaga_brightness"></a>
</h2>
<p>One advantage of retrieving the data from <code>LuciernagaQC()</code>
ExportType = “fcs” outputs is that we can generate an additional type of
plot to look at the individual brightness for the cells that clustered
within the isolated signatures. This is accomplished by switching up a
couple arguments in <code><a href="../reference/Luciernaga_FCSToReport.html">Luciernaga_FCSToReport()</a></code> and passing
the intermediate to the <code><a href="../reference/Luciernaga_Brightness.html">Luciernaga_Brightness()</a></code>
function</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ReferencePath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">PanelPath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">ReferencePath</span>, <span class="st">"Panel.csv"</span><span class="op">)</span></span>
<span><span class="va">PanelNames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">PanelPath</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PanelNames</span> <span class="op">&lt;-</span> <span class="va">PanelNames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">Fluorophore</span>, <span class="st">"Pacific"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PanelNames</span> <span class="op">&lt;-</span> <span class="va">PanelNames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Fluorophore <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>    <span class="va">Fluorophore</span> <span class="op">==</span> <span class="st">"FITC"</span> <span class="op">~</span> <span class="st">"AlexaFluor488"</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Fluorophore</span>  <span class="co"># Keep all other values unchanged</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PanelItems</span> <span class="op">&lt;-</span> <span class="va">PanelNames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">Fluorophore</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"-A"</span>, <span class="st">""</span>, <span class="va">.</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">BrightnessOutput</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_FCSToReport.html">Luciernaga_FCSToReport</a></span><span class="op">(</span>path<span class="op">=</span><span class="va">StorageLocation</span>, reference<span class="op">=</span><span class="va">PanelNames</span>, stats<span class="op">=</span><span class="st">"median"</span>,</span>
<span>                      RetainedType <span class="op">=</span> <span class="st">"raw"</span>, experiment<span class="op">=</span><span class="st">"FirstExperiment"</span>, condition<span class="op">=</span><span class="st">"ILTExperiement"</span>, </span>
<span>                      TheSummary <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PanelItems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"."</span>, <span class="st">""</span>, fixed<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">PanelItems</span><span class="op">)</span></span>
<span><span class="va">PanelItems</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">""</span>, fixed<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">PanelItems</span><span class="op">)</span></span>
<span><span class="co">#PanelItems &lt;- gsub("-", "", fixed=TRUE, PanelItems)</span></span>
<span></span>
<span><span class="va">BrightnessOutput</span><span class="op">$</span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"."</span>, <span class="st">""</span>, fixed<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">BrightnessOutput</span><span class="op">$</span><span class="va">Sample</span><span class="op">)</span></span>
<span><span class="va">BrightnessOutput</span><span class="op">$</span><span class="va">Sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">""</span>, fixed<span class="op">=</span><span class="cn">TRUE</span>, <span class="va">BrightnessOutput</span><span class="op">$</span><span class="va">Sample</span><span class="op">)</span></span>
<span><span class="co">#BrightnessOutput$Sample &lt;- gsub("-", "", fixed=TRUE, BrightnessOutput$Sample)</span></span>
<span></span>
<span><span class="va">BrightnessPlots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">PanelItems</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">28</span><span class="op">:</span><span class="fl">29</span><span class="op">)</span><span class="op">]</span>, .f<span class="op">=</span><span class="va">Luciernaga_Brightness</span>, data<span class="op">=</span><span class="va">BrightnessOutput</span>,                       reference<span class="op">=</span><span class="va">PanelNames</span>, Scaled<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ThePlot</span> <span class="op">&lt;-</span> <span class="va">BrightnessPlots</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">ThePlot</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span><span class="va">ThePlot</span><span class="op">)</span></span></code></pre></div>
<p>In the above example, we needed to modify the list to exclude
PacificBlue Fluorophore that failed to generate in
<code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code>. The Panel.CSV also had a mismatch (FITC
instead AlexaFluor488) that we had to rename. And in my version the
APC-Fire810 bugged. So resolve these to fix this vignette :( and make it
easier to work with.</p>
<p>The resulting brightness plot is a geom_density plot showing the MFI
for the respective clustered signatures. As you can tell from the
ggplot2 object, a bunch of the signatures are relatively dim, which
reflects the case seen in signatures.</p>
</div>
<div class="section level2">
<h2 id="luciernaga_lists">Luciernaga_Lists<a class="anchor" aria-label="anchor" href="#luciernaga_lists"></a>
</h2>
<p><code><a href="../reference/Luciernaga_Lists.html">Luciernaga_Lists()</a></code> is a wrapper function that allows us
to merge in the <code><a href="../reference/Luciernaga_Brightness.html">Luciernaga_Brightness()</a></code> plots with
<code><a href="../reference/Luciernaga_Plots.html">Luciernaga_Plots()</a></code> plots to generate a more complete view
of the fluorescent signatures for given samples. In addition to being
able to return a “pdf” plot, it can also be used to generate a “html”
output that is interactive (at the cost of being more storage space used
on your computer)</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FinalPlots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Luciernaga_Lists.html">Luciernaga_Lists</a></span><span class="op">(</span>ListOfList <span class="op">=</span> <span class="va">TheMainPlots</span>, SecondaryList <span class="op">=</span> <span class="va">BrightnessPlots</span>, thecolumns <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                               therows <span class="op">=</span> <span class="fl">3</span>, width<span class="op">=</span><span class="fl">9</span>, height<span class="op">=</span><span class="fl">7</span>, ReturnFolder <span class="op">=</span> <span class="va">ReferencePath</span>,</span>
<span>                               CurrentExperiment <span class="op">=</span> <span class="st">"Test"</span>, PlotType <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualizing-longitudinally">Visualizing Longitudinally<a class="anchor" aria-label="anchor" href="#visualizing-longitudinally"></a>
</h2>
<p>All of the above functions focused their work primarily in the
context of visualizing the variation in <code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code>
isolated fluorescent signatures within the context of a single
experiment. But what happens when we want to look longitudinally across
a series of experiments to monitor for tandem degradation in an antibody
vial, or pinpoint if the instrumental issue impacted fluorophore
signatures on a particular day?</p>
<p>The following functions are still in active development, and require
a little more upfront coding on the part of the user to ensure that the
data.frame object is tidy compatible, but we attach the workflow
below.</p>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>And this concludes the vignette covering how to visualize the
<code><a href="../reference/Luciernaga_QC.html">Luciernaga_QC()</a></code> outputs to leverage insight into what is
occuring within individual fluorophores for a given experiment and
across time. Thanks for your patience and happy visualizing.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Rach.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
