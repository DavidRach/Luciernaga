<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dimensionality Visualization • Luciernaga</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dimensionality Visualization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Luciernaga</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/DataVisualization.html">Data Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/DimensionalityVisualization.html">Dimensionality Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/QualityControl.html">Quality Control</a></li>
    <li><a class="dropdown-item" href="../articles/FluorescenceSignatures.html">Fluorescence Signatures</a></li>
    <li><a class="dropdown-item" href="../articles/FluorescentReports.html">Fluorescent Reports</a></li>
    <li><a class="dropdown-item" href="../articles/Unmixing.html">Unmixing with Luciernaga</a></li>
    <li><a class="dropdown-item" href="../articles/Wetlab.html">Wetlab Helper Functions</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DavidRach/Luciernaga/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dimensionality Visualization</h1>
                        <h4 data-toc-skip class="author">David Rach</h4>
            <address class="author_afil">
      University of Maryland,
Baltimore<br><a class="author_email" href="mailto:#"></a><a href="mailto:drach@som.umaryland.edu" class="email">drach@som.umaryland.edu</a>
      </address>
                  
            <h4 data-toc-skip class="date">1 June 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DavidRach/Luciernaga/blob/HEAD/vignettes/DimensionalityVisualization.Rmd" class="external-link"><code>vignettes/DimensionalityVisualization.Rmd</code></a></small>
      <div class="d-none name"><code>DimensionalityVisualization.Rmd</code></div>
    </div>

    
    
<p>knitr::opts_chunk$set(eval = FALSE)</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Spectral Flow Cytometry data consist of many acquired cellular
events, with increasing number of markers. Many unsupervised analysis
approaches rely on clustering the markers on the basis of median
fluorescent intensity. A common workflow step is to then project these
cells onto a dimensionality visualized space using one of the various
available algorithms. While this can provide useful information, we
agree with Pachter labs points in their Specious Art Spatial Genomics
paper highlighting ease of overinterpreting what may be sheer artefact
noise.</p>
<p>Similarly, dimensionality visualization works on both unmixed files,
as well as novel applications addressing unstained samples still in the
raw form. To enable characterization of what actually ends up in these
islands (whether brightness, unique signature, random noise) we have
implemented dimensionality visualization for the most frequently used
algorithms to facilitate their exploration in context of our paper.</p>
<p>While these are useful, we would like to reiterate, these wrappers
are for exploratory/convenience purposes only, please refer to the
original packages for any specialized argument implementation. We may
modify them, so don’t build your own R package around our
implementation. Instead, take advantage of the copyleft license nature
of free and open-source software, fork it, modify it and include it in
your own package.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="load-libraries">Load Libraries<a class="anchor" aria-label="anchor" href="#load-libraries"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://davidrach.github.io/Luciernaga/">Luciernaga</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">flowCore</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">flowWorkspace</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">openCyto</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/ggcyto/issues" class="external-link">ggcyto</a></span><span class="op">)</span>  </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://plotly-r.com" class="external-link">plotly</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/htmltools" class="external-link">htmltools</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="create-a-gatingset">Create a GatingSet<a class="anchor" aria-label="anchor" href="#create-a-gatingset"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">File_Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">FCS_Pattern</span> <span class="op">&lt;-</span> <span class="st">".fcs$"</span></span>
<span><span class="va">FCS_Files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">File_Location</span>, pattern <span class="op">=</span> <span class="va">FCS_Pattern</span>,</span>
<span>                        full.names <span class="op">=</span> <span class="cn">TRUE</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">FCS_Files</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span>, <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UnstainedFCSFiles</span> <span class="op">&lt;-</span> <span class="va">FCS_Files</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Unstained"</span>, <span class="va">FCS_Files</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">UnstainedCells</span> <span class="op">&lt;-</span> <span class="va">UnstainedFCSFiles</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span></span>
<span>  <span class="st">"Beads"</span>, <span class="va">UnstainedFCSFiles</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyCytoSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/load_cytoset_from_fcs.html" class="external-link">load_cytoset_from_fcs</a></span><span class="op">(</span><span class="va">UnstainedCells</span>,</span>
<span>                                   truncate_max_range <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                   transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">MyCytoSet</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">MyCytoSet</span><span class="op">)</span></span>
<span><span class="va">MyGatingSet</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FileLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">MyGates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">FileLocation</span>,</span>
<span>                           pattern <span class="op">=</span> <span class="st">'Gates.csv'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">MyGates</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MyGatingTemplate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gatingTemplate-class.html" class="external-link">gatingTemplate</a></span><span class="op">(</span><span class="va">MyGates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gt_gating.html" class="external-link">gt_gating</a></span><span class="op">(</span><span class="va">MyGatingTemplate</span>, <span class="va">MyGatingSet</span><span class="op">)</span></span>
<span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creating-a-gating-set-unmixed">Creating a Gating Set Unmixed<a class="anchor" aria-label="anchor" href="#creating-a-gating-set-unmixed"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Unmixed_FullStained</span> <span class="op">&lt;-</span> <span class="va">FCS_Files</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Unmixed"</span>, <span class="va">FCS_Files</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">UnmixedCytoSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/load_cytoset_from_fcs.html" class="external-link">load_cytoset_from_fcs</a></span><span class="op">(</span><span class="va">Unmixed_FullStained</span>,</span>
<span>                                        truncate_max_range <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                        transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">UnmixedGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">UnmixedGatingSet</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span></span>
<span>  <span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">MyBiexponentialTransform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/flowjo_biexp_trans.html" class="external-link">flowjo_biexp_trans</a></span><span class="op">(</span>channelRange <span class="op">=</span> <span class="fl">256</span>,</span>
<span>                                               maxValue <span class="op">=</span> <span class="fl">1000000</span>,</span>
<span>                                               pos <span class="op">=</span> <span class="fl">4.5</span>, neg <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                                               widthBasis <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">TransformList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/transformerList.html" class="external-link">transformerList</a></span><span class="op">(</span><span class="va">KeptMarkers</span>, <span class="va">MyBiexponentialTransform</span><span class="op">)</span></span>
<span><span class="va">UnmixedGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span>, <span class="va">TransformList</span><span class="op">)</span></span>
<span></span>
<span><span class="va">FileLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"Luciernaga"</span><span class="op">)</span></span>
<span><span class="va">UnmixedGates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">FileLocation</span>,</span>
<span>                                pattern <span class="op">=</span> <span class="st">'GatesUnmixed.csv'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">UnmixedGating</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gatingTemplate-class.html" class="external-link">gatingTemplate</a></span><span class="op">(</span><span class="va">UnmixedGates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/openCyto/man/gt_gating.html" class="external-link">gt_gating</a></span><span class="op">(</span><span class="va">UnmixedGating</span>, <span class="va">UnmixedGatingSet</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="helper-functions">Helper Functions<a class="anchor" aria-label="anchor" href="#helper-functions"></a>
</h2>
<div class="section level3">
<h3 id="utility_colappend">Utility_ColAppend<a class="anchor" aria-label="anchor" href="#utility_colappend"></a>
</h3>
<p>Originally an internal function supporting our dimensionality
visualization functions, <code><a href="../reference/Utility_ColAppend.html">Utility_ColAppend()</a></code> appends new
data.frame columns to an .fcs file that contains the same number of rows
as a new marker/parameter. To do this, you feed the function a cytoset
object, a data.frame of the flowframe exprs data, and a data.frame of
the new data columns. <code><a href="../reference/Utility_ColAppend.html">Utility_ColAppend()</a></code> then adds the
appropriate parameters and returns a flowframe object with these new
parameters added.</p>
<p>Since it has been highly useful to us, we are mentioning it here in
case you need to append additional information/alternate dimensionality
visualizations to your own .fcs files. We have tried to keep the return
.fcs file compliant for ease of use in other software applications, but
expect bugs to arise outside internal function purpose, so if you
encounter a bug with this function, please report it via GitHub.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gh_pop_get_data.html" class="external-link">gs_pop_get_data</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, subsets<span class="op">=</span><span class="st">"live"</span>,</span>
<span>                      inverse.transform <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">BeforeParameters</span> <span class="op">&lt;-</span> <span class="va">ff</span><span class="op">[[</span><span class="fl">1</span>, returnType <span class="op">=</span> <span class="st">"flowFrame"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">BeforeParameters</span></span>
<span></span>
<span><span class="co"># Main Expression Data From Original</span></span>
<span><span class="va">MainDataFrame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">ff</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Creating Artificial Data To Mimic Metadata to Append</span></span>
<span><span class="va">NewData</span> <span class="op">&lt;-</span> <span class="va">MainDataFrame</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>  ExposureStatus <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NewData</span> <span class="op">&lt;-</span> <span class="va">NewData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ExposureStatus</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AfterParameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_ColAppend.html">Utility_ColAppend</a></span><span class="op">(</span>ff<span class="op">=</span><span class="va">ff</span>, DF<span class="op">=</span><span class="va">MainDataFrame</span>,</span>
<span>                                     columnframe <span class="op">=</span> <span class="va">NewData</span><span class="op">)</span></span>
<span><span class="va">AfterParameters</span></span></code></pre></div>
<p>For anyone wanting to continue on and create an .fcs file from the
flowframe, example code is provided below:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">outpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span><span class="va">Name</span> <span class="op">&lt;-</span> <span class="fu">flowWorkspace</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/keyword-methods.html" class="external-link">keyword</a></span><span class="op">(</span><span class="va">AfterParameters</span>, <span class="st">"GROUPNAME"</span><span class="op">)</span></span>
<span><span class="va">TheFileName</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Name</span>, <span class="st">"_Appended.fcs"</span><span class="op">)</span></span>
<span><span class="va">fileSpot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">outpath</span>, <span class="va">TheFileName</span><span class="op">)</span></span>
<span><span class="va">fileSpot</span></span>
<span><span class="co"># flowCore::write.FCS(AfterParameters, filename = fileSpot, delimiter="#")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="utility_downsample">Utility_Downsample<a class="anchor" aria-label="anchor" href="#utility_downsample"></a>
</h3>
<p>For many dimensionality visualization protocols, it’s recommended
that you downsample so that each specimen has roughly similar
representation in the final plot. While this can be helpful when you
have some specimens with 10,000 cells, and others with a million cells,
it encounters issues when some specimens have millions but other samples
have just 200 cells. Consequently, deciding whether to down-sample is a
decision that you need to make and justify. We have implemented
<code><a href="../reference/Utility_Downsample.html">Utility_Downsample()</a></code> to facilitate the process.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot(UnmixedGatingSet)</span></span>
<span><span class="va">CountData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_count_fast.html" class="external-link">gs_pop_get_count_fast</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">)</span></span>
<span><span class="va">CountData</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/flowCore/man/filter-methods.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Population</span> <span class="op"><a href="https://rdrr.io/pkg/flowCore/man/filter-in-methods.html" class="external-link">%in%</a></span> <span class="st">"/singletsFSC/singletsSSC/singletsSSCB/nonDebris/lymphocytes/live"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">Count</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Single Sample Returned as a data.frame </span></span>
<span><span class="va">removestrings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DTR_2023_ILT_15_Tetramers-"</span>,</span>
<span>                   <span class="st">"-Ctrl_Tetramer_Unmixed"</span>, <span class="st">".fcs"</span><span class="op">)</span></span>
<span><span class="va">SingleSample</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_Downsample.html">Utility_Downsample</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                                   sample.name <span class="op">=</span> <span class="st">"GROUPNAME"</span>,</span>
<span>                                   removestrings<span class="op">=</span><span class="va">removestrings</span>,</span>
<span>                                   subsets <span class="op">=</span> <span class="st">"live"</span>, subsample <span class="op">=</span> <span class="fl">2500</span>,</span>
<span>                                   internal <span class="op">=</span> <span class="cn">FALSE</span>, export <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                   inverse.transform<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">SingleSample</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple Samples</span></span>
<span></span>
<span><span class="va">MultipleSamples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">UnmixedGatingSet</span>, .f<span class="op">=</span><span class="va">Utility_Downsample</span>,</span>
<span>                       sample.name <span class="op">=</span>  <span class="st">"GROUPNAME"</span>, removestrings<span class="op">=</span><span class="va">removestrings</span>,</span>
<span>                       subsets <span class="op">=</span> <span class="st">"live"</span>, subsample <span class="op">=</span> <span class="fl">2500</span>, internal <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       export <span class="op">=</span> <span class="cn">FALSE</span>, inverse.transform<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">MultipleSamples</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="utility_concatinate">Utility_Concatinate<a class="anchor" aria-label="anchor" href="#utility_concatinate"></a>
</h3>
<p>A common feature of dimensionality visualization approaches for
cytometry data is concatenating different samples into a single file.
This sometimes includes first downsampling to an equivalent number of
cells in a particular cell subset, so as to not overly influence the
result on the basis of a single cell subset. Similarly, this can be done
before or after cells are normalized using one of the various
algorithms.</p>
<p>To facilitate this process, we have implemented the
<code><a href="../reference/Utility_Concatinate.html">Utility_Concatinate()</a></code> function. Unlike other approaches, we
implemented it at the GatingSet level, allowing to merge only cells at
the gating node of interest into active memory. The final file can then
be saved as it’s own .fcs file. We have attempted to retain FCS format,
so that it can be used across software without issues. If you encounter
issues, please reach out!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">removestrings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DTR_"</span>, <span class="st">".fcs"</span><span class="op">)</span></span>
<span><span class="va">StorageLocation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"C:"</span>, <span class="st">"Users"</span>, <span class="st">"JohnDoe"</span>, <span class="st">"Desktop"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Return Types: "data.frame", "flow.frame", "fcs"</span></span>
<span><span class="va">ConcatinatedReturn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_Concatinate.html">Utility_Concatinate</a></span><span class="op">(</span>gs<span class="op">=</span><span class="va">UnmixedGatingSet</span>,</span>
<span>                                          sample.name <span class="op">=</span> <span class="st">"GROUPNAME"</span>,</span>
<span>                                          removestrings<span class="op">=</span><span class="va">removestrings</span>,</span>
<span>                                          subsets<span class="op">=</span><span class="st">"live"</span>, subsample <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                                          ReturnType <span class="op">=</span> <span class="st">"flow.frame"</span>,</span>
<span>                                          newName <span class="op">=</span> <span class="st">"MyConcatinatedFile"</span>,</span>
<span>                                          outpath <span class="op">=</span> <span class="va">StorageLocation</span>,</span>
<span>                                          export <span class="op">=</span> <span class="cn">FALSE</span>, inverse.transform<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ConcatinatedReturn</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="utility_tsne">Utility_tSNE<a class="anchor" aria-label="anchor" href="#utility_tsne"></a>
</h3>
<p>Now that we have a GatingSet containing our raw .fcs files, let’s
figure out what markers/parameters are present, and save the detectors
as “KeptMarkers”. From there, let’s identify the unstained file within
the GatingSet. After this we will run a tSNE on the provided data at the
lymphocyte gating level, using the <code><a href="../reference/Utility_tSNE.html">Utility_tSNE()</a></code> function.
This function has the ability to return a .fcs file (which is what we
typically use). For the purpose of this vignette, it returns as a
FlowCore flowframe. For use with our visualization functions that work
on GatingSet objects, we transform to a cytoframe, add to a new cytoset
and then convert that into a gating set. Finally we visualize using
<code><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots()</a></code></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MyCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">KeptMarkers</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tSNE_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_tSNE.html">Utility_tSNE</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name <span class="op">=</span> <span class="st">"GUID"</span>,</span>
<span>                            removestrings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_Cells"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                            subset <span class="op">=</span> <span class="st">"nonDebris"</span>, columns<span class="op">=</span><span class="va">KeptMarkers</span>,</span>
<span>                            export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">tSNE_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TSNEPlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                     xaxis<span class="op">=</span><span class="st">"tSNE_1"</span>, yaxis <span class="op">=</span> <span class="st">"tSNE_2"</span>,</span>
<span>                                     zaxis <span class="op">=</span><span class="st">"B3-A"</span>, splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                     sample.name <span class="op">=</span> <span class="st">"TUBENAME"</span>,</span>
<span>                                     removestrings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dimensionality"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                                     thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">TSNEPlot</span> </span></code></pre></div>
<p>We can now repeat the previous step, but using our Unmixed file
GatingSet. The process is similar, identifying markers present in the
.fcs file (fluorophores in this case), selecting our markers of
interest, and from there passing to the <code><a href="../reference/Utility_tSNE.html">Utility_tSNE()</a></code>
function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">SubsetMarkers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BUV496-A"</span>, <span class="st">"BUV805-A"</span>, <span class="st">"Pacific Blue-A"</span>, <span class="st">"BV711-A"</span>,</span>
<span>                       <span class="st">"BV786-A"</span>, <span class="st">"Spark Blue 550-A"</span>, <span class="st">"PE-A"</span>, <span class="st">"APC-Fire 750-A"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">removestrings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".fcs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tSNE_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_tSNE.html">Utility_tSNE</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name <span class="op">=</span> <span class="st">"TUBENAME"</span>, removestrings<span class="op">=</span><span class="va">removestrings</span>, subset <span class="op">=</span> <span class="st">"live"</span>, columns<span class="op">=</span><span class="va">SubsetMarkers</span>, export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#BUGGED: flowCore_$P42Rmax not contained in Text section!</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">tSNE_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_TSNEPlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                            xaxis<span class="op">=</span><span class="st">"tSNE_1"</span>, yaxis <span class="op">=</span> <span class="st">"tSNE_2"</span>,</span>
<span>                                            zaxis <span class="op">=</span><span class="st">"Spark Blue 550-A"</span>,</span>
<span>                                            splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                            sample.name <span class="op">=</span> <span class="st">"GROUPNAME"</span>,</span>
<span>                                            removestrings <span class="op">=</span> <span class="va">removestrings</span>, </span>
<span>                                            thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_TSNEPlot</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="utility_umap">Utility_UMAP<a class="anchor" aria-label="anchor" href="#utility_umap"></a>
</h3>
<p>Now that we have a GatingSet containing our raw .fcs files, let’s
figure out what markers/parameters are present, and save the detectors
as “KeptMarkers”. From there, let’s identify the unstained file within
the GatingSet. After this we will run a tSNE on the provided data at the
lymphocyte gating level, using the <code><a href="../reference/Utility_UMAP.html">Utility_UMAP()</a></code> function.
This function has the ability to return a .fcs file (which is what we
typically use). For the purpose of this vignette, it returns as a
FlowCore flowframe. For use with our visualization functions that work
on GatingSet objects, we transform to a cytoframe, add to a new cytoset
and then convert that into a gating set. Finally we visualize using
<code><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots()</a></code></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MyCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">KeptMarkers</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UMAP_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_UMAP.html">Utility_UMAP</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>,</span>
<span>                            removestrings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_Cells"</span>, <span class="st">".fcs"</span><span class="op">)</span>, </span>
<span>                            subset<span class="op">=</span><span class="st">"nonDebris"</span>, columns<span class="op">=</span><span class="va">KeptMarkers</span>,</span>
<span>                            export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">UMAP_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UMAPPlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                     xaxis<span class="op">=</span><span class="st">"UMAP_1"</span>, yaxis <span class="op">=</span> <span class="st">"UMAP_2"</span>, </span>
<span>                                     zaxis <span class="op">=</span><span class="st">"B3-A"</span>, splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                     sample.name <span class="op">=</span> <span class="st">"TUBENAME"</span>,</span>
<span>                                     removestrings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dimensionality"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                                     thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UMAPPlot</span></span></code></pre></div>
<p>We can now repeat the previous step, but using our Unmixed file
GatingSet. The process is similar, identifying markers present in the
.fcs file (fluorophores in this case), selecting our markers of
interest, and from there passing to the <code><a href="../reference/Utility_UMAP.html">Utility_UMAP()</a></code>
function.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">SubsetMarkers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BUV496-A"</span>, <span class="st">"BUV805-A"</span>, <span class="st">"Pacific Blue-A"</span>, <span class="st">"BV711-A"</span>,</span>
<span>                       <span class="st">"BV786-A"</span>, <span class="st">"Spark Blue 550-A"</span>, <span class="st">"PE-A"</span>, <span class="st">"APC-Fire 750-A"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">removestrings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".fcs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">UMAP_Output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Utility_UMAP.html">Utility_UMAP</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>, removestrings<span class="op">=</span><span class="va">removestrings</span>, subset<span class="op">=</span><span class="st">"live"</span>, columns<span class="op">=</span><span class="va">SubsetMarkers</span>, export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">UMAP_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_UMAPPlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                            xaxis<span class="op">=</span><span class="st">"UMAP_1"</span>, yaxis <span class="op">=</span> <span class="st">"UMAP_2"</span>,</span>
<span>                                            zaxis <span class="op">=</span><span class="st">"Spark Blue 550-A"</span>,</span>
<span>                                            splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                            sample.name <span class="op">=</span> <span class="st">"GROUPNAME"</span>,</span>
<span>                                            removestrings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dimensionality"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                                            thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_UMAPPlot</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="utility_pacmap">Utility_PaCMAP<a class="anchor" aria-label="anchor" href="#utility_pacmap"></a>
</h3>
<p>Unlike the other dimensionality visualization algorithms that are
implemented in R, both PaCMAP and PHATE are primarily implemented in
Python. Utilizing <code>basilisk</code> package, we implement method to
facilitate the plot generation isolated within the Luciernaga
environment. To do this, you would need to install either the devel or
WithPython branches when downloading from GitHub.</p>
<p>Repeating similar steps as with the tSNE and UMAP examples above for
both raw and unmixed data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MyCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">KeptMarkers</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PaCMAP_Output</span> <span class="op">&lt;-</span> <span class="fu">Utility_PaCMAP</span><span class="op">(</span>x<span class="op">=</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>,</span>
<span>                            removestrings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_Cells"</span>, <span class="st">".fcs"</span><span class="op">)</span>, </span>
<span>                            subset<span class="op">=</span><span class="st">"nonDebris"</span>, columns<span class="op">=</span><span class="va">KeptMarkers</span>,</span>
<span>                            export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">PaCMAP_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PaCMAPPlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                     xaxis<span class="op">=</span><span class="st">"PaCMAP_1"</span>, yaxis <span class="op">=</span> <span class="st">"PaCMAP_2"</span>, </span>
<span>                                     zaxis <span class="op">=</span><span class="st">"B3-A"</span>, splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                     sample.name <span class="op">=</span> <span class="st">"TUBENAME"</span>,</span>
<span>                                     removestrings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dimensionality"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                                     thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PaCMAPPlot</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">SubsetMarkers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BUV496-A"</span>, <span class="st">"BUV805-A"</span>, <span class="st">"Pacific Blue-A"</span>, <span class="st">"BV711-A"</span>,</span>
<span>                       <span class="st">"BV786-A"</span>, <span class="st">"Spark Blue 550-A"</span>, <span class="st">"PE-A"</span>, <span class="st">"APC-Fire 750-A"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">removestrings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".fcs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PaCMAP_Output</span> <span class="op">&lt;-</span> <span class="fu">Utility_PaCMAP</span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>, </span>
<span>                              removestrings<span class="op">=</span><span class="va">removestrings</span>, subset<span class="op">=</span><span class="st">"live"</span>,</span>
<span>                              columns<span class="op">=</span><span class="va">SubsetMarkers</span>, export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">PaCMAP_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_PaCMAPPlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                            xaxis<span class="op">=</span><span class="st">"PaCMAP_1"</span>, yaxis <span class="op">=</span> <span class="st">"PaCMAP_2"</span>,</span>
<span>                                            zaxis <span class="op">=</span><span class="st">"Spark Blue 550-A"</span>,</span>
<span>                                            splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                            sample.name <span class="op">=</span> <span class="st">"GROUPNAME"</span>,</span>
<span>                                            removestrings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dimensionality"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                                            thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_PaCMAPPlot</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="utility_phate">Utility_PHATE<a class="anchor" aria-label="anchor" href="#utility_phate"></a>
</h3>
<p>And similarly for PHATE, with downsampling for brevity:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MyCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">KeptMarkers</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MyGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Phate_Output</span> <span class="op">&lt;-</span> <span class="fu">Utility_Phate</span><span class="op">(</span>x<span class="op">=</span><span class="va">MyGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>,</span>
<span>                            removestrings<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"_Cells"</span>, <span class="st">".fcs"</span><span class="op">)</span>, </span>
<span>                            subset<span class="op">=</span><span class="st">"nonDebris"</span>, subsample<span class="op">=</span><span class="fl">15000</span>,</span>
<span>                            columns<span class="op">=</span><span class="va">KeptMarkers</span>,</span>
<span>                            export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">Phate_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PhatePlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                     xaxis<span class="op">=</span><span class="st">"Phate_1"</span>, yaxis <span class="op">=</span> <span class="st">"Phate_2"</span>, </span>
<span>                                     zaxis <span class="op">=</span><span class="st">"B3-A"</span>, splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                     sample.name <span class="op">=</span> <span class="st">"TUBENAME"</span>,</span>
<span>                                     removestrings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dimensionality"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                                     thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PhatePlot</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">UnmixedCytoSet</span><span class="op">)</span></span>
<span><span class="va">KeptMarkers</span> <span class="op">&lt;-</span> <span class="va">Markers</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Time|FS|SC|SS|Original|-W$|-H$|AF"</span>, <span class="va">Markers</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">SubsetMarkers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BUV496-A"</span>, <span class="st">"BUV805-A"</span>, <span class="st">"Pacific Blue-A"</span>, <span class="st">"BV711-A"</span>,</span>
<span>                       <span class="st">"BV786-A"</span>, <span class="st">"Spark Blue 550-A"</span>, <span class="st">"PE-A"</span>, <span class="st">"APC-Fire 750-A"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/phenoData.html" class="external-link">pData</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">UnmixedGatingSet</span><span class="op">)</span></span>
<span></span>
<span><span class="va">removestrings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".fcs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Phate_Output</span> <span class="op">&lt;-</span> <span class="fu">Utility_Phate</span><span class="op">(</span>x<span class="op">=</span><span class="va">UnmixedGatingSet</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, sample.name<span class="op">=</span><span class="st">"GUID"</span>, </span>
<span>                              removestrings<span class="op">=</span><span class="va">removestrings</span>, subset<span class="op">=</span><span class="st">"live"</span>,</span>
<span>                              subsample<span class="op">=</span><span class="fl">5000</span>, </span>
<span>                              columns<span class="op">=</span><span class="va">SubsetMarkers</span>, export<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/convert.html" class="external-link">flowFrame_to_cytoframe</a></span><span class="op">(</span><span class="va">Phate_Output</span><span class="op">)</span></span>
<span><span class="va">TheNewCS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cytoset.html" class="external-link">cytoset</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/cs_add_cytoframe.html" class="external-link">cs_add_cytoframe</a></span><span class="op">(</span>cs<span class="op">=</span><span class="va">TheNewCS</span>, sn<span class="op">=</span><span class="st">"Test"</span>, cf<span class="op">=</span><span class="va">cf</span><span class="op">)</span></span>
<span><span class="va">NewGatingSet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/GatingSet-class.html" class="external-link">GatingSet</a></span><span class="op">(</span><span class="va">TheNewCS</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_PhatePlot</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/Utility_ThirdColorPlots.html">Utility_ThirdColorPlots</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">NewGatingSet</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, subset <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>                                            xaxis<span class="op">=</span><span class="st">"Phate_1"</span>, yaxis <span class="op">=</span> <span class="st">"Phate_2"</span>,</span>
<span>                                            zaxis <span class="op">=</span><span class="st">"Spark Blue 550-A"</span>,</span>
<span>                                            splitpoint <span class="op">=</span> <span class="st">"continuous"</span>,</span>
<span>                                            sample.name <span class="op">=</span> <span class="st">"GROUPNAME"</span>,</span>
<span>                                            removestrings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dimensionality"</span>, <span class="st">".fcs"</span><span class="op">)</span>,</span>
<span>                                            thecolor <span class="op">=</span> <span class="st">"orange"</span>, tilesize <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Sample_PhatePlot</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Rach.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
